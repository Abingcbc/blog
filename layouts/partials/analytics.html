<script async src="https://umami-7s5zgr1xg-abingcbc.vercel.app/script.js"
    data-website-id="44a33e30-d386-4df7-a6ed-1ebe3a80d752"></script>
    <link type="text/css" rel="stylesheet" href="/css/custom.css">
    {{ $scr := .Scratch }}
    {{ $css := site.Data.assets.css }}
    {{ $js := site.Data.assets.js }}
  
    {{/* Config LaTeX math rendering. */}}
    {{ if or .Params.math site.Params.features.math.enable }}
      {{ $mathjax_config := resources.Get "js/mathjax-config.js" }}
      <script src="{{ $mathjax_config.RelPermalink }}"></script>
    {{ end }}
  
    {{/* Attempt to load local vendor CSS, otherwise load from CDN. */}}
  
    {{/* Only load non-essential CSS in this media-swapping way */}}
    {{- $stylesheets := slice -}}
    {{- $lib_names := slice "fontawesome/all.min" -}}
    {{- range $lib_names -}}
      {{- $stylesheets = $stylesheets | append (resources.Get (printf "css/libs/%s.css" . ) ) -}}
    {{- end -}}
    {{ $stylesheets = $stylesheets | resources.Concat "css/vendor-bundle.css" | minify }}
    {{- if eq (getenv "WC_POST_CSS") "true" -}}
      {{- $stylesheets = $stylesheets | postCSS -}}
    {{- end -}}
    {{- if hugo.IsProduction -}}
      {{- $stylesheets = $stylesheets | fingerprint "md5" -}}
    {{- end -}}
    {{- if eq (getenv "WC_POST_CSS") "true" -}}
      {{/* PostProcess must be last action in the pipeline */}}
      {{- $stylesheets = $stylesheets | resources.PostProcess -}}
    {{- end -}}
    <link rel="stylesheet" href="{{$stylesheets.RelPermalink}}" media="print" onload="this.media='all'">
  
    {{ $scr.Set "vendor_css_filename" "main.min.css" }}
    {{ $scr.Set "vendor_js_filename" "main.min.js" }}
    {{ if and (fileExists (printf "static/css/vendor/%s" ($scr.Get "vendor_css_filename"))) (fileExists (printf "static/js/vendor/%s" ($scr.Get "vendor_js_filename"))) }}
      {{ $scr.Set "use_cdn" 0 }}
      <link rel="stylesheet" href="{{ printf "/css/vendor/%s" ($scr.Get "vendor_css_filename") | relURL }}" />
    {{ else }}
      {{ $scr.Set "use_cdn" 1 }}
      {{ if site.Params.extensions.academicons.enable }}
        {{ printf "<link rel=\"stylesheet\" href=\"%s\" integrity=\"%s\" crossorigin=\"anonymous\" media=\"print\" onload=\"this.media='all'\">" (printf $css.academicons.url $css.academicons.version) $css.academicons.sri | safeHTML }}
      {{ end }}
  
      {{/* Workaround `.HasShortcode "gallery"` not parsing page resources (widget page sections) */}}
      {{ $has_gallery := false }}
      {{/* Note: unless there is a root `/index.md` with `type: widget_page`, Hugo treats homepage as `page` type. */}}
      {{ if (eq .Type "widget_page") | or (and .IsHome (eq .Type "page")) }}
        {{/* Check if widget page sections use a gallery */}}
        {{ $page := "/home/index.md" }}
        {{ $context := cond .IsHome (site.GetPage $page) . }}
        {{ range $context.Resources.ByType "page" }}
          {{ if .HasShortcode "gallery" }}
            {{ $has_gallery = true }}
          {{ end }}
        {{ end }}
      {{ else }}
        {{/* Single page */}}
        {{ if .HasShortcode "gallery" | or ($.Page.Store.Get "has_gallery") }}
          {{ $has_gallery = true }}
        {{ end }}
      {{ end }}
      {{ if (eq .Type "landing") }}
        {{ range $index, $block := .Params.sections }}
          {{ if (gt (len (findRE `\{\{< gallery` $block.content.text 1)) 0) }}
            {{ $.Page.Store.Set "has_gallery" true }}
            {{ $has_gallery = true }}
          {{ end }}
        {{ end }}
      {{ end }}
      {{ if $has_gallery | or site.Params.require_fancybox }}
        {{ printf "<link rel=\"stylesheet\" href=\"%s\" integrity=\"%s\" crossorigin=\"anonymous\" media=\"print\" onload=\"this.media='all'\">" (printf $css.fancybox.url $css.fancybox.version) $css.fancybox.sri | safeHTML }}
      {{ end }}
  
      {{/* Maps CSS. */}}
      {{ $map_provider := lower site.Params.features.map.provider }}
      {{ if in (slice "mapnik" "mapbox") $map_provider }}
        {{ printf "<link rel=\"stylesheet\" href=\"%s\" integrity=\"%s\" crossorigin=\"anonymous\" media=\"print\" onload=\"this.media='all'\">" (printf $css.leaflet.url $css.leaflet.version) $css.leaflet.sri | safeHTML }}
      {{ end }}
  
      {{/* Load async scripts. */}}
      {{ range $k, $v := site.Data.assets.js }}
        {{/* TODO: investigate why `where ... "async" true` does not work. */}}
        {{ $load := $v.async }}
  
        {{/* Only load MathJax if required. */}}
        {{ if (eq $k "mathJax") | and (not (or $.Params.math site.Params.features.math.enable)) }}
          {{ $load = false }}
        {{ end }}
  
        {{ if $load }}
          {{ printf "<script src=\"%s\" integrity=\"%s\" crossorigin=\"anonymous\" async></script>" (printf $v.url $v.version) $v.sri | safeHTML }}
        {{ end }}
      {{ end }}
    {{ end }}
  
    {{/* Load WC community block styles */}}
    {{ $wc_block_styles := resources.Match "scss/blocks/**.scss" }}
    {{ with $wc_block_styles }}
      {{ $wc_block_styles = $wc_block_styles | resources.Concat "css/wowchemy-blocks.scss" | resources.ToCSS }}
      {{- if eq (getenv "WC_POST_CSS") "true" -}}
        {{- $wc_block_styles = $wc_block_styles | postCSS -}}
      {{- end -}}
      {{- if hugo.IsProduction -}}
        {{- $wc_block_styles = $wc_block_styles | minify | fingerprint "md5" -}}
      {{- end -}}
      {{- if eq (getenv "WC_POST_CSS") "true" -}}
        {{/* PostProcess must be last action in the pipeline */}}
        {{- $wc_block_styles = $wc_block_styles | resources.PostProcess -}}
      {{- end -}}
      <link rel="stylesheet" href="{{ $wc_block_styles.RelPermalink }}" />
    {{ end }}