---
title: "[实习小结] 2020暑期实习——阿里巴巴数据中台团队"
date: 2021-06-12 17:35:16
categories:
- Internship
---
毕设做完之后，人终于可以闲下来了。趁这段难得的时间，就想着整理一下自己过去一年发生的事。因为过去一年确确实实是我人生中对我改变最多的一年，无论是从技术上，还是从为人处世上，我感觉自己都得到了很大的提升。所以，本文是这一系列总结的第一篇，先来小结下在阿里实习的经历，之后应该还会分别写两篇文章总结下在字节实习和保研的经历。
<!-- more -->

我在阿里实习期间主要是参与了数据中台 Dataphin 项目的一个 OpenAPI 网关的开发工作，主要的需求来源是另一个系统需要集成 Dataphin 的功能。总体上来说，我应该是完整的跟完了整个的项目流程，这在实习生之中也是很难得的。在我离职后不久，看了眼官网，使用 OpenAPI 网关的集成版系统就已经上线了。在实习的后期，由于这个项目进入到了收尾阶段。我还参与了资源调度服务的调研和设计工作，跟着学习了资源调度相关的知识。但很可惜的是，没来得及真正参与到开发中就离职了。

OpenAPI 主要是要解决外部服务，如何访问到系统的多个微服务。首先，服务注册发现肯定是必须的，借助于我 mentor 设计的 RPC 框架，每个微服务都通过注解的形式自动向外暴露 RPC 接口，然后注册到 Redis 中去。注册的 key 为方法的签名，value 为下游微服务的地址。网关在收到一个外部的请求后，会先会在验证外部请求身份的有效性，然后根据其 header 中所包含的调用信息，查询自己本地的一个关系型数据库。关系型数据库中记录了外部方法名和内部 RPC 方法签名之间的对应关系，并且记录了两者参数之间的对应关系。根据这个对应关系，将外部的 HTTP 请求，转换为 RPC 调用。接着就可以根据 Redis 中的注册信息，去调用内部真正的微服务，并且对其输入和输出都进行统一的封装。当然，这里还会涉及到很多并发以及缓存的优化，但是由于时间有点久了，我自己也想不起来了。\_(:зゝ∠)\_

在调试过程中，我印象最深的一个 bug 就是 RPC 对于 JSON 转化的问题。之前内部 RPC 框架都是使用 Java 的二进制编码形式，所以内部服务之前一直没有遇到任何问题。但是为了 OpenAPI 的 HTTP 调用，网关使用了 Json 编码版本的 RPC。而当遇到 HashMap 中嵌套了一个对象时，gson 就没法把对象转化出来了，导致业务代码读取的时候不是对象，而是一个 HashMap。这种情况，在 RPC 层并不太容易解决，所以最终还是推动了业务侧进行了重载，提供了另一套直接从入参而不是 HashMap 中获取对象。

同时，网关还为 Client 侧提供了一个 SDK，在 aliyun 的 OpenAPI SDK 的基础上进行了一层很薄的封装，为后端的每一个服务封装一个调用函数，在 header 中填入这个接口对应的外部方法名，并且将入参放入到 HTTP 请求中对应的位置。

资源调度主要是原有的 Mesos 的调度下无法满足业务的需求，所以需要自定义设计开发。我印象中最深，也是让我眼前一亮的是，为了解决私有化部署的客户的网络问题，新的调度系统在网络通信上有很多巧妙的设计，保持了单向的通信。资源调度是一个两级调度，Mesos 下面还会有一个 K8s 集群来调度。当时，我被分配到了 K8s 的 Agent 的一个版本升级工作，重构之前废弃的代码。也就是从这个时候开始，我开始了漫长的云之旅，也为后面我在字节实习埋下了伏笔。

不仅仅如此，我觉得最重要的是，在实习过程中，我真正学习到了一个成熟的软件开发流程，看到了整个团队是怎样进行合作完成一个几十万行代码组成的应用。这些知识是在学校里很难学习到的。虽然在学校里，我们也会学习像软件工程这类的课程，但是对于当时学习的我们实在是太抽象了，我们根本上就无法理解这些方法论的来源以及怎么样落地的，当时无论是老师还是学生都只按本宣科和死记硬背。但真正进入到工作场景中去，我才意识到这些方法论的重要性。与技术的水平高低相比，这些方法论可能才是真正能提升软件开发的效率的大杀器。

虽然在阿里实习期间收获很多，但是还是有很多可惜的地方。从技术上来说，自己没有学到很多东西，逐渐变成了一个廉价劳动力。在实习的中后期，时间都被安排到了测试工作上。虽然测试也是软件开发中很重要的一环，但每天重复来重复去的写测试，落差还是蛮大的。

当然，这里也有我自己的问题。没能及时和 mentor 沟通，没能积极表现证明自己的水平。这也是离职后，我不断反思自己的地方，自己在当时的确太过于年轻，甚至说由于疫情在家时间太久的原因有点自闭，这都是自己成长之路上的教训，在未来要时刻提醒自己。

总的来说，在阿里的实习是很宝贵的一段经历，认识了很多对我人生都帮助巨大的人，也和大家度过了一段很欢乐的时光。
